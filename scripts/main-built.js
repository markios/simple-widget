define("BackboneTouch",["Lodash","Backbone"],function(e,t){var n=function(t,n){return t&&t[n]?e.isFunction(t[n])?t[n]():t[n]:null},i=/^(\S+)\s*(.*)$/;return e.extend(t.View.prototype,{_touching:!1,touchPrevents:!0,isTouch:"ontouchstart"in document,delegateEvents:function(t){if(t||(t=n(this,"events"))){this.undelegateEvents();var s=".delegateEvents"+this.cid;e(t).each(function(n,o){if(e.isFunction(n)||(n=this[t[o]]),!n)throw new Error('Method "'+t[o]+'" does not exist');var r=o.match(i),a=r[1],d=r[2],l=e.bind(this._touchHandler,this);n=e.bind(n,this),this.isTouch&&"click"===a?(this.$el.on("touchstart"+s,d,l),this.$el.on("touchend"+s,d,{method:n},l)):(a+=s,""===d?this.$el.bind(a,n):this.$el.on(a,d,n))},this)}},_touchHandler:function(e){if("changedTouches"in e.originalEvent){var t=e.originalEvent.changedTouches[0],n=t.clientX,i=t.clientY;switch(e.type){case"touchstart":this._touching=[n,i];break;case"touchend":var s=this._touching[0],o=this._touching[1],r=10;if(s+r>n&&n>s-r&&o+r>i&&i>o-r){if(this._touching=!1,this.touchPrevents){var a=e.currentTarget.tagName;("BUTTON"===a||"A"===a)&&(e.preventDefault(),e.stopPropagation())}e.data.method(e)}}}}}),t}),define("libs/base",["jQuery","Lodash","openbox","Backbone"],function(e,t,n){var i={defer:function(e){var n=this;return t.bind(function(t){this.hasDeffered=setTimeout(function(){t.apply(n)},e)},this)},onPhaseDetails:function(e){this.setParamsWith(this.phaseTarget,e).buildUrl().beginPolling().fetch()},setParamsWith:function(e,i){var s=t.where(i,{c_Phase:e})[0];return this.params={phaseId:s.n_Phase1ID,languageCode:n.params.languageCode||2},this},beginPolling:function(){var e=this;return this.interval=setInterval(function(){e.buildUrl().fetch()},this.pollSpeed||8e3),this},buildUrl:function(){return this.url=this.urlPart.format(this.params.phaseId,this.params.languageCode,Date.now()),this},platformIsTablet:function(){return!this.platformIsMobile()&&this.platformIsNative()},platformIsNative:function(){return null!=n.params.preview?!0:null!=(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i))},platformIsWeb:function(){return!this.platformIsNative()},platformIsMobile:function(){return null!=n.params.preview?!0:this.platformIsNative()&&e("body").width()<=410},framework:Backbone.Events};return i}),define("views/base-view",["jQuery","Lodash","Backbone","openbox","libs/base"],function(e,t,n,i,s){var o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a="{0} {1} {2} {3}",d=e("body,html"),l=n.View.extend({showBusy:function(){e('<div class="loading">').html(this.message||this.viewName+" will begin soon...").appendTo(this.$el)},_ordinal:function(e,t){var n=e%10,i=1===~~(e%100/10)?"th":1===n?"st":2===n?"nd":3===n?"rd":"th";return t?i:e+i},hideBusy:function(){this.$(".loading").remove()},scrollTo:function(e){"string"==typeof e&&(e=d[0].scrollHeight),this.platformIsNative()?d.scrollTop(e):d.animate({scrollTop:e},1e3)},framework:{},getFriendlyDateString:function(e){return e="string"==typeof e?new Date(e):e,a.format(r[e.getDay()],this._ordinal(e.getDate()),o[e.getMonth()],e.getFullYear())},addAppendView:function(e,n){var i=new e(t.extend({model:this.model},n));return this.$el.append(i.$el),this.views.push(i),i}});return t.extend(l.prototype,s),l}),define("models/base-collection",["jQuery","Lodash","Backbone","openbox","libs/base"],function(e,t,n,i,s){var o=n.Collection.extend({deepFind:function(e,t){var n,i=t.split("."),s=e,o=i.length;for(n=0;o>n;++n){if(void 0===s[i[n]])return void 0;s=s[i[n]]}return s}});return t.extend(o.prototype,s),o}),define("libs/utils",["openbox"],function(e){var t=e.params.host||window.location.host,n=document.getElementsByTagName("body")[0],i=!1,s="animation",o="",r="Webkit Moz O ms Khtml".split(" "),a="";if(n.style.animationName&&(i=!0),i===!1)for(var d=0;d<r.length;d++)if(void 0!==n.style[r[d]+"AnimationName"]){a=r[d],s=a+"Animation",o="-"+a.toLowerCase()+"-",i=!0;break}return{host:t,ordinal:function(e){var t=e%10,n=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n},transistionEvent:"webkitTransitionEnd oTransitionEnd otransitionend transitionend",supportsAnimation:i}}),define("models/phase-weekend-collection",["jQuery","Lodash","Backbone","models/base-collection","libs/utils"],function(e,t,n,i){return i.extend({_onPhaseDetails:function(){this.hasDeffered||this.defer(0)(this._onAfterAdd)},_onAfterAdd:function(){this.framework.trigger("phase:details",this.toJSON())},url:"../../../assets/sports/f1/api/json.php?method=GetGPWeekend&eventPhaseId={0}&languageCode={1}&_={2}",_buildUrl:function(){this.url=this.url.format(openbox.params.eventPhaseId,openbox.params.languageCode||2,Date.now())},initialize:function(){this._buildUrl(),this.on("add",this._onPhaseDetails,this)}})}),define("models/race-collection",["jQuery","Lodash","Backbone","models/base-collection","libs/utils"],function(e,t,n,i){var s=function(e){return/lap/g.test(e)},o=function(e){return null!==e.c_AbandonReason};return i.extend({_onDrivers:function(){openbox.log("added driver"),this.hasDeffered||this.defer(0)(this._onAfterDriversAdd)},_onAfterDriversAdd:function(){this.trigger("drivers:returned",this.models),this.hasDeffered=!1},_displayTime:function(e){var t="";return t=1===e.n_RankSort?"leader":e.abandoned?"abandoned":e.c_Result?this._setDisplayTime(e):"tba"},_setDisplayTime:function(e){return(e.relativeTime||e.c_Result)+(!e.lapped&&" sec")},urlPart:"../../../assets/sports/f1/api/json.php?method=GetGPResultLive&phaseId={0}&languageCode={1}&_={2}",roundTime:function(e){var t=e.replace("+","");if(/\d:/.test(t)){var n=+t.replace(/(:\d.+)/g,"");t=+t.split(":")[1]+60*n}return+t},calculateRelative:function(e,t){var n=this.roundTime(e)-this.roundTime(t);return Math.round(100*n)/100},phaseTarget:"Race",parse:function(e){var t={},n=0;if(e&&e.length>0){for(var i=0,r=e.length;r>i;i++)e[i].lapped=s(e[i].c_Result),e[i].abandoned=o(e[i]),e[i].lapped&&(e[i].lappedCount=t[e[i].c_Result]||e[i].c_AbandonReason?null:t[e[i].c_Result]=1),e[i].id=e[i].n_PersonID,e[i].c_Rank||(e[i].n_RankSort=i+1),e[i].abandoned||(n=i),this.models.length||1!==e[i].n_RankSort||(e[i].isSelected=!0),!e[i].abandoned&&!e[i].lapped&&e[i].n_RankSort>2&&(e[i].relativeTime="+ {0}".format(this.calculateRelative(e[i].c_Result,e[i-1].c_Result))),e[i].displayTime=this._displayTime(e[i]);return e[n].isLast=!0,e}this.framework.trigger("race:notstarted")},getLastNonAbandonedDriver:function(){return t.last(this.where({c_AbandonReason:null}))},initialize:function(){this.on("add",this._onDrivers,this),this.framework.on("phase:details",this.onPhaseDetails,this)}})}),define("models/qualifying-collection",["jQuery","Lodash","Backbone","models/base-collection","libs/utils"],function(e,t,n,i){return i.extend({_onDrivers:function(){this.hasDeffered||this.defer(0)(this._onAfterDriversAdd)},_onAfterDriversAdd:function(){this.trigger("qualifying:returned",this.models),this.hasDeffered=!1},urlPart:"../../../assets/sports/f1/api/json.php?method=GetGPResult&phaseId={0}&languageCode={1}&_={2}",phaseTarget:"Starting grid",parse:function(e){if(e&&e.length){for(var t=0,n=e.length;n>t;t++)e[t].id=e[t].n_PersonID;return e}},initialize:function(){this.framework.on("phase:details",this.onPhaseDetails,this),this.on("add",this._onDrivers,this)}})}),define("models/phase-model",["jQuery","Lodash","Backbone","libs/base","libs/utils"],function(e,t,n,i){var s=n.Model.extend({urlPart:"../../../assets/sports/f1/api/json.php?method=GetGPPhaseInfo&phaseId={0}&languageCode={1}&_={2}",parse:function(e){return e?e[0]:void 0},phaseTarget:"Race",pollSpeed:15e3,initialize:function(){this.framework.on("phase:details",this.onPhaseDetails,this)}});return t.extend(s.prototype,i),s}),define("views/loading-view",["jQuery","Lodash","Backbone","openbox","views/base-view"],function(e,t,n,i,s){return s.extend({_onReady:function(){this.$el.addClass("ready");var e=this;setTimeout(function(){e.$el.hide()},1e3),this.framework.trigger("content:loaded")},_progress:function(e){this.loaded=e,this.$progress.css({width:this.loaded+"%"})},_preload:function(e){var n=this,i=!this.platformIsNative(),s=e.length;t.each(e,function(e){var t=new Image;t.src=i?e.replace("@2x",""):e,t.onload=function(){s-=1,n._progress(n._loadingBits),0===s&&n._onReady()}})},_onPhaseLoaded:function(){this._progress(50),this.$(".message").html("Loading race details....")},_onModelLoaded:function(){this._progress(100),this.defer(300)(this._onReady)},_onRaceNotStarted:function(){this._progress(0),this.$(".message").html("Race begins soon")},loaded:0,initialize:function(){this.framework.on("phase:details",this._onPhaseLoaded,this),this.framework.on("race:notstarted",this._onRaceNotStarted,this),this.collection.on("drivers:returned",this._onModelLoaded,this),this.$progress=this.$("#progressBar"),this.render()},render:function(){return this}})}),define("text",["module"],function(e){var t,n,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,o=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,r="undefined"!=typeof location&&location.href,a=r&&location.protocol&&location.protocol.replace(/\:/,""),d=r&&location.hostname,l=r&&(location.port||void 0),c=[],h=e.config&&e.config()||{};return t={version:"2.0.3",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(o);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:h.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=i[t];try{e=new ActiveXObject(n)}catch(s){}if(e){i=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),i=e.substring(0,n),s=e.substring(n+1,e.length);return n=s.indexOf("!"),-1!==n&&(t=s.substring(n+1,s.length),t="strip"===t,s=s.substring(0,n)),{moduleName:i,ext:s,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,s){var o,r,a,d=t.xdRegExp.exec(e);return d?(o=d[2],r=d[3],r=r.split(":"),a=r[1],r=r[0],!(o&&o!==n||r&&r.toLowerCase()!==i.toLowerCase()||(a||r)&&a!==s)):!0},finishLoad:function(e,n,i,s){i=n?t.strip(i):i,h.isBuild&&(c[e]=i),s(i)},load:function(e,n,i,s){if(s.isBuild&&!s.inlineText)return i(),void 0;h.isBuild=s.isBuild;var o=t.parseName(e),c=o.moduleName+"."+o.ext,u=n.toUrl(c),p=h.useXhr||t.useXhr;!r||p(u,a,d,l)?t.get(u,function(n){t.finishLoad(e,o.strip,n,i)},function(e){i.error&&i.error(e)}):n([c],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)})},write:function(e,n,i){if(c.hasOwnProperty(n)){var s=t.jsEscape(c[n]);i.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,i,s,o){var r=t.parseName(n),a=r.moduleName+"."+r.ext,d=i.toUrl(r.moduleName+"."+r.ext)+".js";t.load(a,i,function(){var n=function(e){return s(d,e)};n.asModule=function(e,t){return s.asModule(e,d,t)},t.write(e,a,n,o)},o)}},"node"===h.env||!h.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(n=require.nodeRequire("fs"),t.get=function(e,t){var i=n.readFileSync(e,"utf8");0===i.indexOf("﻿")&&(i=i.substring(1)),t(i)}):"xhr"===h.env||!h.env&&t.createXhr()?t.get=function(e,n,i){var s=t.createXhr();s.open("GET",e,!0),h.onXhr&&h.onXhr(s,e),s.onreadystatechange=function(){var t,o;4===s.readyState&&(t=s.status,t>399&&600>t?(o=new Error(e+" HTTP status: "+t),o.xhr=s,i(o)):n(s.responseText))},s.send(null)}:("rhino"===h.env||!h.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java)&&(t.get=function(e,t){var n,i,s="utf-8",o=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),s)),d="";try{for(n=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),n.append(i);null!==(i=a.readLine());)n.append(r),n.append(i);d=String(n.toString())}finally{a.close()}t(d)}),t}),define("text!templates/car.html",[],function(){return'<div class="car">\n	<div class="lap-details"></div>\n	<div class="result btn"></div>\n</div>\n<div class="details" style="background-image:url(http://zeebox.images.infostradasports.com/images/lib/basic/person/pp_clubteam/medium/<%=n_PersonID%>.png);">\n	<div class="position"></div>\n	<div class="name">\n		<span class="who"><%=c_PersonShort%></span>\n		<span class="team"><%=c_ConstructorTeam%></span>\n	</div>\n</div>\n'}),define("views/car-view",["jQuery","Lodash","Backbone","openbox","views/base-view","text!templates/car.html"],function(e,t,n,i,s,o){var r=10,a=80,d=20,l=50,c=function(e){return null!==e.c_AbandonReason},h=function(e){return/lap/.test(e)},u=function(e){return/\+/g.test(e)};return s.extend({_updatePositionFor:function(e,t){this._setAbandonedStatus(e,t),this.abandoned?this.top=this.actualTop=0:this._recordTop(this._calcTop(e),e.n_RankSort),this._updateCar(e),this.previousPosition=e.n_RankSort,this.model.get("isLast")&&t&&this.framework.trigger("change:last",this.actualTop)},_updateCar:function(e){var t=1===e.lappedCount&&!this.abandoned;this.$el.toggleClass("p1",t).toggleClass("lapped",t).toggleClass("isLast",void 0!==e.isLast).css("top",this.actualTop),this.$(".details .position").html(this._ordinal(e.n_RankSort)),this.$(".car .result").html(e.displayTime).toggleClass("up",e.n_RankSort<this.previousPosition).toggleClass("down",e.n_RankSort>this.previousPosition),t&&this.$(".car .lap-details").html(e.c_Result.replace(/[ \t]|lap/g,""))},_setAbandonedStatus:function(e,t){this.abandoned=c(e),this.$el.toggleClass("abandoned",this.abandoned),t&&this.abandoned&&this.framework.trigger("driver:abandoned",this)},_recordTop:function(e,t){var n=(t-1)*a;this.top=e,this.actualTop=e+n,this.model.set("top",this.top,{silent:!0}),this.model.set("actualTop",this.actualTop,{silent:!0})},_calcTop:function(e){var t=0,n=!e.c_Result;if(n)t=0;else if(h(e.c_Result))t=this.getLastTop()+r,1===e.lappedCount&&(t+=l);else if(u(e.c_Result)){var i=e.c_Result.replace("+",""),s=0;/:/.test(i)&&(s=i.split(":"),i=60*+s[0]+ +s[1]),t+=Math.round(+i)*d}return t},_onChange:function(){i.log("changed",this.model.get("c_Person"));var e=this.model.toJSON();this._updatePositionFor(e,!0),1===e.n_FastestLapRank&&this.framework.trigger("new:fastestRank")},_onDriverChange:function(e){var t=e.id===this.model.id;t&&this.scrollTo(this.abandoned?"bottom":this.actualTop),this.model.set("isSelected",t,{silent:!0}),this.$el.toggleClass("selected",t)},_onMeSelected:function(){this.framework.trigger("driver:selected",this.model)},events:{click:"_onMeSelected"},getLastTop:function(){return this.options.getPreviousTop(this.model.get("n_RankSort"))},className:"driver",initialize:function(){this.model.on("change",this._onChange,this),this.framework.on("driver:selected",this._onDriverChange,this),this.render()},render:function(){var e=this.model.toJSON();return this.$el.append(t.template(o,e)).addClass("in"),1===e.n_RankSort&&this.$el.addClass("selected"),this._updatePositionFor(e,this.options.lastTop),this}})}),define("views/grid-view",["jQuery","Lodash","Backbone","openbox","views/base-view","views/car-view"],function(e,t,n,i,s,o){return s.extend({_getPreviousTop:function(e){var t=this.collection.where({n_RankSort:e})[0];return t&&t.get("top")?t:this._getPreviousTop(e-1)},_setAbandonedTop:function(){var e=this.collection.getLastNonAbandonedDriver().get("actualTop");this.$abandoned.css("top",e+150).show()},_onDriverAbandoned:function(e){this._setAbandonedTop(),this.$abandonedHolder.prepend(e.$el)},className:"race-grid",initialize:function(){this.collection.on("drivers:returned",this.render,this),this.framework.on("driver:abandoned",this._onDriverAbandoned,this),this.framework.on("change:last",this._setAbandonedTop,this),this.$track=this.$(".track"),this.$abandoned=this.$(".abandoned-grid"),this.$abandonedHolder=this.$(".abandoned-grid > .holder")},render:function(e){var n=this,i=[];return t.each(e,function(e){var t=new o({model:e,getPreviousTop:function(e){return n._getPreviousTop(e-1).get("top")}});t.abandoned?(i.push(t),this.$abandonedHolder.append(t.$el)):this.$el.append(t.$el)},this),i.length>0&&this._setAbandonedTop(),this}})}),define("text!templates/profile.html",[],function(){return'<div class="mobile-title">\n	<div class="back">\n	<svg version="1.1" id="Layer_1" xmlns:x="&ns_extend;" xmlns:i="&ns_ai;" xmlns:graph="&ns_graphs;"\n     xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:a="http://ns.adobe.com/AdobeSVGViewerExtensions/3.0/"\n     x="0px" y="0px" width="39px" height="33px" viewBox="0 0 50 45" enable-background="new 0 0 50 45" xml:space="preserve"><g>\n    <polygon points="23.482,37.625 26.439,34.668 15.817,24.046 43.84,24.046 43.84,19.868 15.817,19.868 26.439,9.244 23.482,6.288 10.772,19 7.814,21.957  "/>\n    </g>\n    </svg>\n	</div>\n	<span><%=displayTime%></span>\n</div>\n<div class="position">\n	<div class="driver-pic" style="background-image:url(http://zeebox.images.infostradasports.com/images/lib/basic/person/pp_clubteam/medium/<%=n_PersonID%>.png)"></div>\n	<div class="name"><%=c_Person%></div>\n	<div class="pos_cur">\n		<%if(!c_Rank){ %>\n			-\n		<%} else{%>\n			<%=n_RankSort%><span><%=positionOrdinal%></span> \n    	<%}%>\n		<span class="pos_name">pos</span>\n    </div>\n    <div class="constructor">\n    	<div class="flag <%=c_NOCShort%>"><%=c_ConstructorTeam%></div>\n    </div>\n	<div class="abandoned-message fadeZoom">\n		<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n			 width="16.167px" height="15.833px" viewBox="0 0 16.167 15.833" enable-background="new 0 0 16.167 15.833" xml:space="preserve">\n		<circle fill="#ed040a" cx="7.875" cy="7.958" r="6.875"/>\n		</svg>\n		<span><%=c_AbandonReason%></span>\n	</div>\n	<div class="inpit-message fadeZoom">\n		<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n			 width="16.167px" height="15.833px" viewBox="0 0 16.167 15.833" enable-background="new 0 0 16.167 15.833" xml:space="preserve">\n		<circle fill="#f17316" cx="7.875" cy="7.958" r="6.875"/>\n		</svg>\n		<span>In pit</span>\n	</div>\n	<div class="ontrack-message fadeZoom">\n		<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n			 width="16.167px" height="15.833px" viewBox="0 0 16.167 15.833" enable-background="new 0 0 16.167 15.833" xml:space="preserve">\n		<circle fill="#7dce03" cx="7.875" cy="7.958" r="6.875"/>\n		</svg>\n		<span>On track</span>\n	</div>\n</div>\n<div class="infographics <%if(c_FastestLapTime) print(\'fastest-lap\')%>">\n	<div class="pit-stops">\n		<div class="wrapper">\n			<ul class="clear">\n				<%for(var i=0, j=n_PitStops; i < j; i++) {%>\n					<li class="fadeZoom"></li>\n				<%}%>	\n			</ul>\n		</div>\n		<p>Pit stops</p>\n		<p class="sub"><%=n_PitStops%></p>\n	</div>\n	<div class="grid-position">\n		<div class="grid-graphic"><span><%=gridPosition%></span></div>\n		<p>Grid Position</p>\n		<p class="sub"><%=gridPosition%> / <%=totalDrivers%></p>\n	</div>\n	<%if(c_FastestLapTime){%>\n		<div class="fastest-time">\n			<div class="lap-time"><%=c_FastestLapTime%></div>\n			<p>Fastest Lap Time</p>\n		</div>\n		<div class="fastest-rank">\n			<div class="rank"><%=n_FastestLapRank%><span class="super"><%=fastestLapOrdinal%></span></div>\n			<p>Fastest Lap Rank</p>\n		</div>\n	<%}%>\n</div> \n<!-- <div class="team">\n	<div class="car">\n		<img src="http://zeebox.images.infostradasports.com/images/lib/basic/Sport/Autosport/Attribute/Car/Sideview/Large/<%=year%>/<%=n_ConstructorTeamID%>.png" alt="">\n	</div>\n	<div class="team-name"><%=c_ConstructorTeam%></div>\n</div> -->\n\n\n<div class="profile-nav">\n	<div class="prev <% prevDisabled && print(\'disabled\');%>">\n		<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n			 width="41.833px" height="55.25px" viewBox="0 0 41.833 55.25" enable-background="new 0 0 41.833 55.25" xml:space="preserve">\n		<path fill="#ed040a" d="M9.598,2.93h22.875c2.762,0,5,2.239,5,5v40c0,2.762-2.238,5-5,5H9.598c-2.762,0-5-2.238-5-5v-40\n			C4.598,5.168,6.836,2.93,9.598,2.93z M15.818,30.358l10.437,10.438l2.43-2.427l-8.724-8.724L18.256,27.9l1.704-1.687l8.724-8.723\n			l-2.43-2.428L13.388,27.929L15.818,30.358z"/>\n		</svg>\n	</div>\n	<span><%=n_RankSort%> of <%=totalDrivers%> drivers</span>\n	<div class="next <% nextDisabled && print(\'disabled\');%>">\n		<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n			 width="41.833px" height="55.25px" viewBox="0 0 41.833 55.25" enable-background="new 0 0 41.833 55.25" xml:space="preserve">\n		<path fill="#ed040a" d="M32.473,2.93H9.598c-2.762,0-5,2.239-5,5v40c0,2.762,2.238,5,5,5h22.875c2.762,0,5-2.238,5-5v-40\n			C37.473,5.168,35.235,2.93,32.473,2.93z M26.253,30.358L15.817,40.797l-2.43-2.427l8.724-8.724l1.704-1.746l-1.704-1.687\n			l-8.724-8.723l2.43-2.428l12.866,12.866L26.253,30.358z"/>\n		</svg>\n	</div>\n</div>\n'}),define("views/profile-view",["jQuery","Lodash","Backbone","openbox","views/base-view","text!templates/profile.html"],function(e,t,n,i,s,o){var r,a,d=function(e){return/disabled/g.test(e.currentTarget.className)};return s.extend({_onDrivers:function(){r&&a&&this.render(this.collection.models[0])},_onQualifyLoaded:function(){r=!0,this._onDrivers()},_onRaceLoaded:function(){a=!0,this._onDrivers()},_preloadDriver:function(e){var t=new Image,n=this;t.onload=function(){n.$(".driver-details .position img").addClass("fadeIn")},t.src="http://zeebox.images.infostradasports.com/images/lib/basic/person/pp_clubteam/large/{0}.png".format(e.n_PersonID)},_onModelChange:function(){this.render(this._currentModel)},_unbindCurrent:function(){this._currentModel.off("change",this._onModelChange,this)},_bindToModel:function(e){this._currentModel&&this._unbindCurrent(),this._currentModel=e,this._currentModel.on("change",this._onModelChange,this)},_onNavClick:function(t){if(!d(t)){var n=e(t.currentTarget).hasClass("next"),i=this._currentModel.get("n_RankSort"),s=this.collection.where({n_RankSort:n?i+1:i-1});this.framework.trigger("driver:selected",s[0])}},_onClose:function(){this.$el.removeClass("in")},_onDriverSelected:function(e,t){this.render(e),"fromfinder"!==t&&this.$el.addClass("in")},_condition:function(e){var t="ontrack";return e.c_AbandonReason?t="abandoned":e.b_InPit&&(t="in-pit"),t},initialize:function(){this.collection.on("drivers:returned",this._onRaceLoaded,this),this.qualifyCollection=this.options.qualifyCollection,this.qualifyCollection.on("qualifying:returned",this._onQualifyLoaded,this),this.framework.on("driver:selected",this._onDriverSelected,this)},events:{"click .profile-nav .next, .prev":"_onNavClick","click .back":"_onClose"},render:function(e){var n=e.toJSON();return n.positionOrdinal=this._ordinal(n.n_RankSort,!0),n.gridPosition=this.qualifyCollection.get(n.id).get("c_Rank"),n.gridOrdinal=this._ordinal(n.gridPosition,!0),n.condition=this._condition(n),n.year=(new Date).getFullYear(),n.fastestLapOrdinal=this._ordinal(n.n_FastestLapRank,!0),n.totalDrivers=this.collection.models.length,n.prevDisabled=1===n.n_RankSort,n.nextDisabled=n.n_RankSort===n.totalDrivers,this.$(".driver-details").removeClass("abandoned ontrack in-pit").addClass(n.condition).html(t.template(o,n)),this._bindToModel(e),this.$el.addClass("shown"),this}})}),define("text!templates/find.html",[],function(){return"<%_.each(drivers, function(driver){%>\n	<option <% driver.isSelected && print('selected'); 	%> value=\"<%=driver.id%>\"><%=driver.c_Person%> <% if(driver.n_FastestLapRank === 1) print(' (FL)')%></option>\n<%});%>\n"}),define("views/find-view",["jQuery","Lodash","BackboneTouch","openbox","views/base-view","models/race-collection","text!templates/find.html"],function(e,t,n,i,s,o,r){return s.extend({_onDriverChange:function(e){this.framework.trigger("driver:selected",this.collection.get(e.currentTarget.value),"fromfinder")},_onDriverSelected:function(e,t){t||this.defer(0)(this.render)},events:{"change #find-driver":"_onDriverChange"},initialize:function(){this.collection.on("drivers:returned",this.render,this),this.framework.on("driver:selected",this._onDriverSelected,this),this.framework.on("new:fastestRank",this._onDriverSelected,this)},render:function(){var e=t.sortBy(this.collection.toJSON(),function(e){return e.c_Person}),n=t.template(r,{drivers:e});return this.$("#find-driver").empty().append(n),this}})}),define("views/progress-view",["jQuery","Lodash","Backbone","openbox","views/base-view"],function(e,t,n,i,s){return s.extend({_setModel:function(){this.model&&this._manageBindings("off"),this.model=this.collection.where({n_RankSort:1})[0],this._manageBindings("on")},_manageBindings:function(e){this.model[e]("change:n_RankSort",this._setModel,this),this.model[e]("change:n_LapsAbs",this.render,this)},_onDrivers:function(){this._setModel(),this.render()},initialize:function(){this.totalLaps=+i.params.totalLaps||55,this.collection.on("drivers:returned",this._onDrivers,this)},renderProgressbar:function(e){this.$progress||(this.$progress=this.$(".holder .progress-bar"));var t=Math.round(100*((e.n_LapsAbs||0)/this.totalLaps));return this.$progress.css("width","{0}%".format(t)),this},renderProgressText:function(e){return this.$progressText||(this.$progressText=this.$(".progress-text")),this.$progressText.html("{0} / {1} laps".format(e.n_LapsAbs,this.totalLaps)),this},render:function(){var e=this.model.toJSON();return this.renderProgressbar(e).renderProgressText(e),this}})}),define("views/app-view",["jQuery","Lodash","BackboneTouch","openbox","views/base-view","models/phase-weekend-collection","models/race-collection","models/qualifying-collection","models/phase-model","views/loading-view","views/grid-view","views/profile-view","views/find-view","views/progress-view"],function(e,t,n,i,s,o,r,a,d,l,c,h,u,p){var f;return s.extend({_onShow:function(e){this.model.set("current",e)},_onBackToTop:function(){this.scrollTo(0)},_initSubViews:function(){this.views.push(new l({el:".loading",collection:this.collection})),this.views.push(new c({el:".grid",collection:this.collection})),this.views.push(new h({el:".profile",collection:this.collection,qualifyCollection:this.qualifyCollection})),this.views.push(new u({el:".finder",collection:this.collection})),this.views.push(new p({el:".race-progress",collection:this.collection}))},_onModelLoaded:function(){this.ShareManager=new ShareManager({framework:this.framework,model:this.model}),this.addAppendView(ShareView,{name:"main-share"}),this.addAppendView(MenuView,{model:this.model}),this.platformIsMobile()&&this.addAppendView(MobileShareView,{name:"main-share"})},_addProgressView:function(){},_onPhaseDetails:function(){f||(f="{0} grand prix".format(i.params.raceName||this.phaseModel.get("c_Country")),this.$("header .title .event").html(f)),this.$(".race-status").html("race "+this.phaseModel.get("c_PhaseStatus")),this._addProgressView()},views:[],events:{"click .back-to-top":"_onBackToTop"},initialize:function(){this.collection=new r,this.qualifyCollection=new a,this.phaseWeekendCollection=new o,this.phaseModel=new d,this.phaseModel.on("change",this._onPhaseDetails,this),this._initSubViews(),this.phaseWeekendCollection.fetch(),this.render()},render:function(){return this.$("header .title .main > .big").html((new Date).getFullYear()),this}})}),define("libs/xdr",["jQuery"],function(){window.XDomainRequest&&!jQuery.support.cors&&jQuery.ajaxTransport(function(e){if(e.crossDomain&&e.async){e.timeout&&(e.xdrTimeout=e.timeout,delete e.timeout);var t;return{send:function(n,i){function s(e,n,s,o){t.onload=t.onerror=t.ontimeout=t.onprogress=jQuery.noop,t=void 0,jQuery.event.trigger("ajaxStop"),i(e,n,s,o)}t=new XDomainRequest,t.open(e.type,e.url),t.onload=function(){var e=200,n=t.responseText,i=JSON.parse(t.responseText);i.StatusCode&&i.Message&&(e=i.StatusCode,n=i.Message),s(e,n,{text:n},"Content-Type: "+t.contentType)},t.onerror=function(){s(500,"Unable to Process Data")},t.onprogress=function(){},e.xdrTimeout&&(t.ontimeout=function(){s(0,"timeout")},t.timeout=e.xdrTimeout),t.send(e.hasContent&&e.data||null)},abort:function(){t&&(t.onerror=jQuery.noop(),t.abort())}}}})}),define("libs/client-branding",["openbox"],function(e){e.ready(function(e){var t=function(e){var t=document.createElement("link");return t.type="text/css",t.rel="stylesheet",t.href=e,t};if(e.style){var n=window.location.href.split("style=")[1].replace(/(&.*)/,""),i=document.getElementsByTagName("head")[0],s="./styles/"+n;i.appendChild(t(s+"/style.css")),navigator.userAgent.match(/MSIE/i)&&i.appendChild(t(s+"/ie.css"))}})}),require.config({baseUrl:"scripts",paths:{Lodash:"/openbox/vendor/lodash/1.0.1/lodash.underscore.min",jQuery:["http://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min","/openbox/vendor/jquery/1.9.1/jquery-1.9.1.min"],Backbone:"/openbox/vendor/backbone/1.0.0/backbone-min",BackboneTouch:"libs/backbone-touch",openbox:"/openbox/api/3.1/openbox.min",text:"libs/text"},shim:{jQuery:{exports:"$"},hogan:{exports:"Hogan"},Lodash:{exports:"_"},Backbone:{deps:["Lodash","jQuery"],exports:"Backbone"},openbox:{deps:["jQuery"],exports:"openbox"}}}),require(["jQuery","Lodash","views/app-view","openbox","libs/xdr","libs/client-branding"],function(e,t,n,i){String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:t})};var s=function(){new n({el:"body",version:window.f1version})};i.ready(function(e){i.setWidgetDetails({version:"f1-stats-0.2",partner:"zeebox",supplier:"com.zeebox.au",type:"formula1",desc:"formula1stats"}),s(e)})}),define("main",function(){});
//# sourceMappingURL=main-built.js.map